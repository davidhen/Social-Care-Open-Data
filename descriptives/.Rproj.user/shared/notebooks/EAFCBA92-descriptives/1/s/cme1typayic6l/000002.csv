"0","#Define Basic Plot function"
"0","basic_plot <- function(df, x){"
"0","  "
"0","  plotstats <-"
"0","    df %>%"
"0","    group_by_(x) %>%               "
"0","    summarise_(count = ~n()) %>%"
"0","    mutate_(pct = ~count/sum(count)*100)"
"0","  "
"0","  plot <-                   "
"0","    ggplot(df,aes_(x = x)) +"
"0","    geom_bar() + "
"0","    geom_text(data = plotstats, aes(label=paste0(round(pct,1),""%""),"
"0","                                        y=pct), size=3.5, vjust = -1, colour = ""sky blue"")"
"0","  "
"0","  plot"
"0","}"
"0","#Define facet_plot function"
"0","facet_plot <- function(df, x, y){"
"0","  "
"0","  plotstats <-                   "
"0","    df %>%"
"0","    group_by_(y, x) %>%         "
"0","    summarise_(count = ~n()) %>%"
"0","    mutate_(pct = ~count/sum(count)*100) %>%"
"0","    mutate_(yeartot = ~sum(count))"
"0","  "
"0","  plot <-            "
"0","    ggplot(df,aes_(x = x)) +"
"0","    geom_bar() +"
"0","    facet_wrap(y, scales = ""free"") +"
"0","    geom_text(data = plotstats, aes(label=paste0(round(pct,1),""%""),"
"0","                                    y=pct), size=3.5, vjust = -1, "
"0","              colour = ""sky blue"") +"
"0","    geom_text(data = plotstats,"
"0","            aes(label=paste0(""Total number = "",yeartot), x = Inf, y= Inf),"
"0","                hjust = 1, vjust = 1, colour = ""black"") +"
"0","    theme_economist()"
"0","  plot"
"0","  "
"0","}"
"0","#Define multi-facet plot"
"0","multifacet_plot <- function(df, x, y, z){"
"0","  "
"0","  plotstats <-                   "
"0","    df %>%"
"0","    group_by_(y, z, x) %>%         "
"0","    summarise_(count = ~n()) %>%"
"0","    mutate_(pct = ~count/sum(count)*100) %>%"
"0","    mutate_(yeartot = ~sum(count))"
"0","  "
"0","  plot <-            "
"0","    ggplot(df,aes_(x = x)) +"
"0","    geom_bar() + "
"0","    facet_grid(as.formula(paste(y,""~"", z)), scales = ""free"") +"
"0","    geom_text(data = plotstats, aes(label=paste0(round(pct,1),""%""),"
"0","                                    y=pct), size=3.5, vjust = -1, colour = ""sky blue"") +"
"0","    geom_text(data = plotstats,"
"0","            aes(label=paste0(""Total number = "",yeartot), x = Inf, y= Inf),"
"0","                hjust = 1, vjust = 1, colour = ""black"") +"
"0","    theme_economist()"
"0","  plot"
"0","  "
"0","}"
